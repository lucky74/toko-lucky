<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Menu Lucky Kue Sus</title>
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    <style>
        body { font-family: sans-serif; background: #f8f9fa; padding: 20px; }
        .card { background: white; border-radius: 15px; padding: 15px; margin-bottom: 15px; box-shadow: 0 2px 5px rgba(0,0,0,0.1); }
        .item-row { display: flex; justify-content: space-between; align-items: center; margin-bottom: 10px; }
        .counter { display: flex; align-items: center; gap: 15px; }
        button.qty-btn { width: 35px; height: 35px; border-radius: 50%; border: 1px solid #ddd; background: #fff; font-size: 20px; cursor: pointer; }
        .btn-order { width: 100%; padding: 15px; background: #e67e22; color: white; border: none; border-radius: 10px; font-weight: bold; font-size: 16px; margin-top: 20px; }
        .summary { border-top: 1px dashed #ccc; padding-top: 10px; margin-top: 10px; font-size: 14px; }
    </style>
</head>
<body>

    <h2>ü•ê Menu Lucky</h2>
    
    <div class="card">
        <div class="item-row">
            <div>
                <strong>Sus Strawberry</strong><br>
                <small>Rp 15.000 / Box</small>
            </div>
            <div class="counter">
                <button class="qty-btn" onclick="updateQty('strawberry', -1)">-</button>
                <span id="q-strawberry">0</span>
                <button class="qty-btn" onclick="updateQty('strawberry', 1)">+</button>
            </div>
        </div>

        <div class="item-row">
            <div>
                <strong>Sus Keju</strong><br>
                <small>Rp 15.000 / Box</small>
            </div>
            <div class="counter">
                <button class="qty-btn" onclick="updateQty('keju', -1)">-</button>
                <span id="q-keju">0</span>
                <button class="qty-btn" onclick="updateQty('keju', 1)">+</button>
            </div>
        </div>
    </div>

    <div class="card">
        <div class="summary">
            <div class="item-row"><span>Subtotal:</span> <span id="subtotal">Rp 0</span></div>
            <div class="item-row" style="color: green;"><span>Diskon Level:</span> <span id="diskon-text">0%</span></div>
            <div class="item-row"><strong>TOTAL:</strong> <strong id="total">Rp 0</strong></div>
        </div>
    </div>

    <button class="btn-order" onclick="kirim()">Kirim Pesanan</button>

<script>
    let tg = window.Telegram.WebApp;
    let qty = { strawberry: 0, keju: 0 };
    let harga = 15000;
    
    // LOGIKA LEVEL (Simulasi level dari Game)
    // Di versi ini, kita set otomatis deteksi atau bisa input manual sementara
    let userLevel = 1; 
    let diskonPersen = 5 + ((userLevel - 1) * 2); // Level 1=5%, Level 2=7%, dst.

    function updateQty(item, delta) {
        qty[item] = Math.max(0, qty[item] + delta);
        document.getElementById('q-' + item).innerText = qty[item];
        hitung();
    }

    function hitung() {
        let sub = (qty.strawberry + qty.keju) * harga;
        let potongan = (sub * diskonPersen) / 100;
        let grandTotal = sub - potongan;

        document.getElementById('subtotal').innerText = "Rp " + sub.toLocaleString();
        document.getElementById('diskon-text').innerText = diskonPersen + "% (-Rp " + potongan.toLocaleString() + ")";
        document.getElementById('total').innerText = "Rp " + grandTotal.toLocaleString();
        
        return { sub, potongan, grandTotal };
    }

    function kirim() {
        let res = hitung();
        if (res.sub === 0) return alert("Pilih menu dulu!");

        let pesan = `PESANAN LUCKY:\n`;
        if(qty.strawberry > 0) pesan += `- Sus Strawberry: ${qty.strawberry} box\n`;
        if(qty.keju > 0) pesan += `- Sus Keju: ${qty.keju} box\n`;
        pesan += `\nSubtotal: Rp ${res.sub.toLocaleString()}\n`;
        pesan += `Diskon Level (${diskonPersen}%): -Rp ${res.potongan.toLocaleString()}\n`;
        pesan += `TOTAL BAYAR: Rp ${res.grandTotal.toLocaleString()}`;

        tg.sendData(pesan);
    }
</script>
</body>
</html>
